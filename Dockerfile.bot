# Lightweight Telegram Bot Dockerfile
FROM python:3.11-slim

WORKDIR /app

# Create non-root user
RUN useradd --create-home --shell /bin/bash appuser

# Install only bot dependencies (no heavy ML libs)
COPY pyproject.toml README.md ./
COPY src/telegram ./src/telegram
COPY src/config ./src/config
COPY src/__init__.py ./src/

# Create minimal requirements for bot
RUN pip install --no-cache-dir \
    python-telegram-bot>=21.0 \
    httpx>=0.27.0 \
    pydantic>=2.0 \
    pydantic-settings>=2.0 \
    python-dotenv>=1.0.0

# Switch to non-root user
USER appuser

# Run bot
CMD ["python", "-m", "src.telegram.bot"]
